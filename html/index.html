<!--
	To-Do List:
	
		Create the champion tab
		Add ALL the data.
		Make it PRETTY!
-->



<!DOCTYPE html>
<head>
	<link rel="stylesheet" type="text/css" href="../css/bootstrap.css">
	<link rel="stylesheet" type="text/css" href="../css/bootstrap-theme.css">
	<link rel="stylesheet" type="text/css" href="../css/jquery.tagit.css">
	<link rel="stylesheet" type="text/css" href="../css/tagit.ui-zendesk.css">
	<style>
		.gridView{
			-moz-column-count: 3;
			-moz-column-gap: 20px;
			-webkit-column-count: 3;
			-webkit-column-gap: 20px;
			column-count: 3;
			column-gap: 20px;
		}
	</style>

	<script type="text/javascript" src="../js/jquery-2.0.3.min.js"></script>
	<script type="text/javascript" src="../js/bootstrap.js"></script>
	<script type="text/javascript" src="../js/information.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.12/jquery-ui.min.js" type="text/javascript" charset="utf-8"></script>
	<script type="text/javascript" src="../js/tag-it.min.js"></script>

	<script type="text/javascript">

	//This variable stores the user's picks
		var rolesSelected = "";
	$(document).ready( function () {
		

		initializeSelect();
		//This variable stores the champion results from the user's picks
		var results=[];

		$("#btnGenerate").click(function(){
			results = generateResults(results, rolesSelected);
		});

		$("#btnRandom").click(function(){
			getRandomChampion(results);
		});
		
	});

	

	//This method initializes the select and 
	//dictates what to do after a tag is added and removed
	function initializeSelect(){
		$("#sltRoles").tagit({
			availableTags: roles,
			afterTagAdded: function(event, ui){
				rolesSelected += ui.tagLabel + " | ";
			},
			afterTagRemoved: function(event, ui){
				rolesSelected = rolesSelected.replace(ui.tagLabel+ " | ", "");
			}
		});
	};

	//This function uses the user's picks and 
	//returns an array with the results from those 
	//picks after intersenting the required lists
	function generateResults(results, rolesSelected){

		showProgressBar();
		document.getElementById("progressBar").style.width="20%";

		rolesSelectedArray = rolesSelected.split(" | ");
		results = dctRoles[rolesSelectedArray[0]];

		document.getElementById("progressBar").style.width="40%";

		for (var i = 1; i < rolesSelectedArray.length-1; i++) {
			results = intersection(results, dctRoles[rolesSelectedArray[i]]);
		};
		document.getElementById("progressBar").style.width="60%";
		
		$("#divChampionSelectedList ul").empty();
		
		document.getElementById("progressBar").style.width="100%";


		document.getElementById("progressBar").style.width="0%";

		hideProgressBar();

		displayImages(results);

		return results;


	}

	//This function intersects array1 with everything in array2
	//and returns array1
	function intersection(array1, array2){
		array1 = array1.filter(function(n){
			return array2.indexOf(n) > -1;
		});
		return array1;
	}

	//This function displays the progress bar and hides the generate button
	function showProgressBar(){
		$("#divProgressBar").show();
		$("#btnGenerate").hide();
	}

	//This function hides the progress bar and displays the generate button
	function hideProgressBar(){
		$("#divProgressBar").hide();
		$("#btnGenerate").show();
	}

	//This method 
	function displayImages(results){
		//TO DO
		//take in champion names
		//do some sting magic and fetch image
		//add  image to list in .gridView div
		//alert("boom");

		$.each (results, function (key, value){ 
			imageLocation = "../img/" + value + "_Square_0.png"
			$("#divChampionSelectedList ul").append('<li><img id= "' + value + '" src=' + imageLocation + ' onclick="imgClicked(this);"></img></li>')
		});

		$("#divChampionSelectedList").show();
		$("#divRandomButton").show();
	}

	function imgClicked(img){
		var championName = img.id;
		displayChampionDiv(championName);
	}

	function displayChampionDiv(championName){
		//alert("start");

		$("#divChampInfo").html("");
		var imageLocation = "../img/" + championName + "_Square_0.png";
		var html = 	"<div class=row1>" +
					"	<div class='col-md-6'>" +
					"		<img class='pull-left' src='" + imageLocation + "'></img>" +
					"	</div>" +
					"	<div class='col-md-6'>" +
					"		<ul id='champRolesList' class='pull-right'></ul>" +
					"	</div>" +
					"</div><!--row1-->" +
					"<div class='row2'>" +
					"	<a href='http://www.solomid.net/guides.php?champ=" + championName+ "' id='lnkSolomid' target='_blank'>" +
					"		<img src='../img/solomid.png'/>" +
					"	</a>" +
					"	<a href='http://www.mobafire.com/league-of-legends/" + championName + "-guide' id='lnkmobafire' target='_blank'>" +
					"		<img src='../img/mobafire.png'/>" +
					"	</a>" +
					"</div><!--row2-->" +
					"<div class='row3'>" +
					"	<a href='http://www.championselect.net/champ/" + championName+ "' id='lnkChampionSelect' target='_blank'>" +
					"		<img src='../img/championselect.png'/>" +
					"	</a>" +
					"	<a href='http://www.lolking.net/champions/" + championName+ "' id='lnkmobafire' target='_blank'>" +
					"		<img src='../img/lolking.jpg'/>" +
					"	</a>" +
					"</div><!--row2-->";;
		//alert("after html");
		//alert(html);
		$("#divChampInfo").append(html);
		$("#divChampionSelected").show();

	}

	function getRandomChampion(results){

		var resultsSize = results.length;
		var championSelected = results[Math.floor(Math.random()*resultsSize)];
		displayChampionDiv(championSelected);
	}
 

	</script>

</head>
<boby>
	<div class="masthead">
		<h3>LoLRandomMEH!</h3>
		<div class="navbar navbar-inverse">
			<div class="container">
				<div class="navbar-header">
					<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</button>
				</div><!--navbar-header-->
				<div class="collapse navbar-collapse">
					<ul class="nav navbar-nav">
						<li class="active"><a href="#">Home</a></li>
						<li><a href="#info">Info</a></li>
					</ul>
				</div><!--nav-collapse-->
			</div><!--container-->
		</div><!--navbar navbar-inverse-->
	<div><!--masthead-->
	<div class="container">
		<ul class="nav nav-tabs nav-justified">
			<li class="active"><a href="#">By Role</a></li>
			<li><a href="#">By Champions</a></li>
		</ul>
		<div class="container" id="byRole">
			<div class="row">
				<div class="col-md-12" style="margin-bottom:10px">
					<label>Pick Roles:</label>
					<input type="text" id="sltRoles" size="100"></input>
				</div><!--col-md-12-->
			</div><!--row-->
			<div class="row">
				<div class="col-md-4 col-md-offset-4">
					<input type="button" id="btnGenerate" value="Generate" style="width:100px; margin:0 auto; display:block"/>
					<div class="progress progress-striped active" id="divProgressBar" style="display:none">
						<div class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width:0%" id="progressBar">
							<span class="sr-only">Generate</span>
						</div><!--progress-bar progress-bar-info-->
					</div><!--[progress progress-stripped active-->
				</div><!--col-md-4 col-md-offset-4-->
			</div><!--row-->
			<div class="row">
				<div class="col-md-5" style="border-style:solid; border-width:5px; display:none;" id="divChampionSelectedList">
					<ul id="resultImages" class=gridView></ul>
				</div><!--col-md-5 gridView``-->
				<div class="col-md-2" style="display:none; text-align:center" id="divRandomButton">
					<input type="button" id="btnRandom" value="Random" style="width:100px"/>
				</div><!--col-md-2-->
				<div class="col-md-5" style="border-style:solid; border-width:5px; display:none;" id="divChampionSelected">
					<div class="container" id="divChampInfo">
					</div><!--container-->
				</div><!--col-md-5-->
			</div><!--row-->
		</div><!--container-->
	</div><!--container-->

</body>